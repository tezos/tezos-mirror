(library
 (name tezos_version)
 (instrumentation (backend bisect_ppx))
 (public_name tezos-version)
 (modules bin_version node_version version version_parser generated_git_info current_git_info)
 (libraries tezos-base)
 (flags (:standard -open Tezos_base__TzPervasives)))

(rule
 (targets generated_git_info.ml)
 ; Ensures the hash update whenever a source file is modified ;
 (deps (universe) (:script get-git-info.mlt))
 (action (with-stdout-to %{targets} (run %{ocaml} unix.cma %{script}))))

(ocamllex version_parser)

(executable
 (name print_version)
 (public_name print-version)
 (package tezos-version)
 (modules print_version)
 (libraries tezos-version tezos-base.unix)
 (flags (:standard -open Tezos_version))
 )
