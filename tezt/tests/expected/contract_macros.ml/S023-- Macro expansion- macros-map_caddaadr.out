{ parameter unit ;
  storage (pair (pair nat (pair nat (pair (pair (pair (nat %p) (mutez %value)) nat) nat))) nat) ;
  code { { DUP ;
           DIP { CDR @%% ;
                 { DUP ;
                   DIP { CAR @%% ;
                         { DUP ;
                           DIP { CDR @%% ;
                                 { DUP ;
                                   DIP { CDR @%% ;
                                         { DUP ;
                                           DIP { CAR @%% ;
                                                 { DUP ;
                                                   DIP { CAR @%% ;
                                                         { DUP ;
                                                           CDR @value ;
                                                           { PUSH mutez 1000000 ; ADD } ;
                                                           SWAP ;
                                                           CAR @%% ;
                                                           PAIR %@ %value } } ;
                                                   CDR @%% ;
                                                   SWAP ;
                                                   PAIR %@ %@ } } ;
                                           CDR @%% ;
                                           SWAP ;
                                           PAIR %@ %@ } } ;
                                   CAR @%% ;
                                   PAIR %@ %@ } } ;
                           CAR @%% ;
                           PAIR %@ %@ } } ;
                   CDR @%% ;
                   SWAP ;
                   PAIR %@ %@ } } ;
           CAR @%% ;
           PAIR %@ %@ @new_storage } ;
         NIL operation ;
         SWAP ;
         { CDR @%% ; SWAP ; PAIR % %@ } } }

