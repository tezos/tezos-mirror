# SPDX-FileCopyrightText: 2023 Nomadic Labs <contact@nomadic-labs.com>
# SPDX-FileCopyrightText: 2023 Marigold <contact@marigold.dev>
# SPDX-FileCopyrightText: 2023-2025 Functori <contact@functori.com>
# SPDX-FileCopyrightText: 2023 PK Lab <contact@pklab.io>
# SPDX-FileCopyrightText: 2024 TriliTech <contact@trili.tech>
#
# SPDX-License-Identifier: MIT

[workspace]
resolver = "2"

members = [
  "ethereum",
  "kernel",
  "indexable_storage",
  "tracing",
  "logging",
  "storage",
  "revm",
  "runtime",
]

[workspace.dependencies]

# error handling
thiserror = "1.0"
anyhow = "1.0"

# types
primitive-types = { version = "0.12.1", default-features = false }
num-bigint = { version = "0.4", default-features = false }
num-traits = "0.2.8"
num-derive = "0.4"
ethereum = { version = "0.14.0", default-features = false }
ethbloom = { version = "0.13.0", default-features = false, features = ["rlp"] }
softfloat = "1.0.0"
bytes = "^1"
enum_dispatch = { version = "0.3.13" }

# serialization
hex = "0.4"
hex-literal = "0.4.1"
tezos_data_encoding = { version = "0.6", git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
const-decoder = { version = "0.3.0" }
rlp = "0.5.2"
nom = { version = "7.1", default-features = false }
serde = { version = "1.0", features = ["derive", "rc"] }

# ethereum VM
revm = { version = "33.1.0", default-features = false, features = [ "optional_eip3607" ] }
aurora-engine-modexp = { version = "1.0", default-features = false }
bn = { package = "substrate-bn", version = "0.6", default-features = false }

# crypto stuff
sha2 = { version = "0.10.6", default-features = false }
sha3 = { version = "0.10.6", default-features = false }
ripemd = { version = "0.1.3", default-features = false }
tezos_crypto_rs = { version = "0.6", git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22", default-features = false }
libsecp256k1 = { version = "0.7", default-features = false, features = [
  "static-context",
  "hmac",
] }

# kernel crates
revm-etherlink = { package = "revm-etherlink-farfadet-dev", path = "./revm" }
tezos_ethereum = { package = "tezos_ethereum_farfadet_dev", path = "./ethereum" }
tezos_tezlink = { package = "tezos_tezlink_farfadet_dev", path = "./tezos" }
tezos-execution = { package = "tezos-execution-farfadet-dev", path = "./tezos_execution" }
tezos-evm-logging = { package = "tezos-evm-logging-farfadet-dev", path = "./logging" }
tezos-tracing = { package = "tezos-tracing-farfadet-dev", path = "./tracing" }
tezos-evm-runtime = { package = "tezos-evm-runtime-farfadet-dev", path = "./runtime" }
tezos-indexable-storage = { package = "tezos-indexable-storage-farfadet-dev", path = "./indexable_storage" }
tezos-storage = { package = "tezos-storage-farfadet-dev", path = "./storage" }

# SDK
# we disable BLS, because we donâ€™t need it and it is a roadblock for the native execution

tezos-smart-rollup = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22", default-features = false, features = [
  "std",
  "crypto",
  "dlmalloc",
  "panic-hook",
  "data-encoding",
  "storage",
  "testing",
] }

tezos-smart-rollup-core = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-smart-rollup-host = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-smart-rollup-panic-hook = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-smart-rollup-entrypoint = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-smart-rollup-debug = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-smart-rollup-encoding = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22", default-features = false, features = [
  "alloc",
  "tezos-encoding",
  "crypto",
] }
tezos-smart-rollup-installer-config = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-smart-rollup-mock = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-smart-rollup-storage = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }
tezos-protocol = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22" }

# property based testing
rand = { version = "0.8" }
proptest = { version = "1.0" }
pretty_assertions = { version = "1.4.0" }

# alloy
alloy-sol-types = { version = "1.3.0", default-features = false, features = [
  "json",
] }
alloy-primitives = { version = "1.2.0", default-features = false }
alloy-consensus = { version = "1.0.32", default-features = false }

# mir without bls nor transfer of big maps
mir = { git = "https://gitlab.com/tezos/tezos.git", rev = "c0e4170342cc7c62ced920ecc25af36745447f22", default-features = false }
typed-arena = "2"

# miscs
format_no_std = "1.2.0"

# kernel execution profiling
nop-macros = { version = "0.2.0" }
tracing = { version = "0.1.41", features = ["attributes"] }
syn = { version = "2", features = ["full"] }
quote = "1"

[profile.release]
# Will apply heavy LTO which attempts to perform optimizations across all crates
# within the dependency graph.
lto = true

[profile.release-with-debug]
inherits = "release"
debug = true
