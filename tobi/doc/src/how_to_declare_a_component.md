# How to declare a component

## Component name

Choose a name for your component.
Components are Opam packages, and the name of a component is the name of this Opam package.
In the rest of this guide, we assume the name `COMPONENT`.

## Opam file

Write a file named `opam/COMPONENT.opam` (or have it be generated by the Manifest).
See [What Tobi needs from Opam files](what_Tobi_needs_from_Opam_files.md).

## Update Tobi's configuration file

Declare your component in [Tobi's Configuration file](configuration_file.md).
Currently, this file (`tobi/config`) is generated by the Manifest.
If you already declared your component in the Manifest, you should already
see your component declared in `tobi/config`. You can check with:

    grep ^COMPONENT: tobi/config

from the root of the repository.
If this returns something, your component is already declared.
It may be the case that the Manifest did not declare all necessary paths, however.
To list all paths that are part of your component, run:

    grep ^__pervasive: tobi/config
    grep ^COMPONENT: tobi/config

If a path is missing, you can modify `tobi/config-manual` to add a line of the form:

    COMPONENT: path

Then, regenerate `tobi/config` with:

    make -C manifest

from the root of the repository.

## Test

Commit `tobi/config` and the Opam file of your component and try to install it with:

    tobi install COMPONENT

If it fails, see
[Troubleshooting component installation](troubleshooting_component_installation.md).
