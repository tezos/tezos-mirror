# This file was automatically generated, do not edit.
# Edit file ci/bin/main.ml instead.

oc.build_arm64-released:
  image: ${build_deps_image_name}:runtime-build-dependencies--${build_deps_image_version}
  stage: build
  tags:
  - gcp_arm64
  rules:
  - if: $CI_PIPELINE_SOURCE == "schedule" && $TZ_SCHEDULE_KIND == "EXTENDED_TESTS"
    when: always
  - if: $CI_MERGE_REQUEST_LABELS =~ /(?:^|,)ci--arm64(?:$|,)/
    when: on_success
  - changes:
    - src/**/*
    - .gitlab/**/*
    - .gitlab-ci.yml
    when: manual
    allow_failure: true
  dependencies: []
  before_script:
  - ./scripts/ci/take_ownership.sh
  - . ./scripts/version.sh
  - eval $(opam env)
  script:
  - ./scripts/ci/build_full_unreleased.sh
  variables:
    ARCH: arm64
    EXECUTABLE_FILES: script-inputs/released-executables
  artifacts:
    name: build-$ARCH-$CI_COMMIT_REF_SLUG
    expire_in: 1 day
    paths:
    - octez-*
    - src/proto_*/parameters/*.json
    - _build/default/src/lib_protocol_compiler/bin/main_native.exe
    - _build/default/tezt/tests/main.exe
    - _build/default/contrib/octez_injector_server/octez_injector_server.exe
    when: on_success
